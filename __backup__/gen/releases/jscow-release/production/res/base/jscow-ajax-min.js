/* jscow - Javascript Component Framework - jscow-ajax-trunk - Mario Linz - http://www.jscow.de */jsCow.res.components.ajax=function(){};jsCow.res.components.ajax.prototype={init:function(){return this},setDefaultMVC:function(){this.setModel(jsCow.res.model.ajax);this.setController(jsCow.res.controller.ajax);return this},setData:function(a){this.globalEvents.trigger("setData",{data:a},this);return this},setUrl:function(a){this.globalEvents.trigger("setUrl",{url:a},this);return this},setDataType:function(a,c){var b={dataType:a};if(typeof c!="undefined"){if(c=="?"){}else{b.jsonpCallback=c}}this.globalEvents.trigger("setDataType",b,this);return this},jsonpCallbackParam:function(a){var b={};if(typeof a!="undefined"){b.jsonpCallbackParam=a}this.globalEvents.trigger("jsonpCallbackParam",b,this);return this},setRequestType:function(a){this.globalEvents.trigger("setRequestType",{type:a},this);return this},setContentType:function(a){this.globalEvents.trigger("setContentType",{contentType:a},this);return this},exec:function(){this.globalEvents.trigger("exec",{},this);return this}};jsCow.res.model.ajax=function(){this.type="jsCow.res.model.ajax";this.config={globalDisabled:false,enabled:true,header:{url:false,type:"POST",dataType:"json",contentType:false},data:{}}};jsCow.res.model.ajax.prototype={init:function(){},setData:function(a){if(this.isEnabled()){$.extend(true,this.config.data,a.data.data)}return this},setUrl:function(a){if(this.isEnabled()){this.config.header.url=a.data.url}return this},setDataType:function(a){if(this.isEnabled()){if(a.data.dataType.toLowerCase()==="json"||a.data.dataType.toLowerCase()==="xml"||a.data.dataType.toLowerCase()==="jsonp"){this.config.header.dataType=a.data.dataType;if(typeof a.data.jsonpCallback!="undefined"){this.config.header.jsonpCallback=a.data.jsonpCallback}}}return this},setRequestType:function(a){if(this.isEnabled()){this.config.header.type=a.data.type}return this},setContentType:function(a){if(this.isEnabled()){this.config.header.contentType=a.data.contentType}return this},getDataObject:function(a){if(a!=undefined){if(this.config.header.dataType.toLowerCase()=="json"){return $.parseJSON(a)}else{if(this.config.header.dataType.toLowerCase()=="jsonp"){return a}else{if(this.config.header.dataType.toLowerCase()=="xml"){return $.parseXML(a)}}}}return false},jsonpCallbackParam:function(a){if(this.isEnabled()){this.config.header.jsonpCallbackParam=a.data.jsonpCallbackParam}return this},exec:function(c){if(this.isEnabled()){var b=this;var a={type:this.config.header.type,url:this.config.header.url,data:this.config.data,error:function(d){b.error(d)}};if(this.events.isEventExists("beforeSend")){a.beforeSend=function(d){b.beforeSend(d)}}if(this.events.isEventExists("dataFilter")){a.dataFilter=function(d){b.dataFilter(d)}}if(this.events.isEventExists("success")){a.success=function(d){b.success(d)}}if(this.events.isEventExists("complete")){a.complete=function(d){b.complete(d)}}a.data.header=this.config.header;a.data.header.time=Math.round(new Date().getTime()/1000);if(this.config.header.contentType){a.contentType=this.config.header.contentType}else{delete (a.data.header.contentType)}if(this.config.header.dataType==="jsonp"){a.dataType=this.config.header.dataType;if(this.config.header.jsonpCallback!==undefined){a.jsonpCallback=this.config.header.jsonpCallback}if(this.config.header.jsonpCallbackParam!==undefined){a.jsonp=this.config.header.jsonpCallbackParam}}$.ajax(a)}return this},beforeSend:function(a){if(this.isEnabled()){this.events.trigger("beforeSend",a)}return this},success:function(a){if(this.isEnabled()){this.events.trigger("success",this.getDataObject(a))}return this},dataFilter:function(a){if(this.isEnabled()){this.events.trigger("dataFilter",this.getDataObject(a))}return this},complete:function(a){if(this.isEnabled()){this.events.trigger("complete",this.getDataObject(a))}return this},error:function(a){if(this.isEnabled()){this.events.trigger("error",a)}return this}};jsCow.res.controller.ajax=function(){this.type="jsCow.res.controller.ajax"};jsCow.res.controller.ajax.prototype={init:function(){},handleSetData:function(a){if(this.isMethodExists(this.getModel().setData)){this.getModel().setData(a)}return false},handleSetUrl:function(a){if(this.isMethodExists(this.getModel().setUrl)){this.getModel().setUrl(a)}return false},handleSetDataType:function(a){if(this.isMethodExists(this.getModel().setDataType)){this.getModel().setDataType(a)}return false},handleJsonpCallbackParam:function(a){if(this.isMethodExists(this.getModel().jsonpCallbackParam)){this.getModel().jsonpCallbackParam(a)}return false},handleSetRequestType:function(a){if(this.isMethodExists(this.getModel().setRequestType)){this.getModel().setRequestType(a)}return false},handleSetContentType:function(a){if(this.isMethodExists(this.getModel().setContentType)){this.getModel().setContentType(a)}return false},handleExec:function(a){if(this.isMethodExists(this.getModel().exec)){this.getModel().exec(a)}return false}};